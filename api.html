

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>API Reference &mdash; AFQ-Insight 0.2.5 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/afqinsight.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery-dataframe.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/js/copybutton.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contributing to AFQ-Insight" href="contributing.html" />
    <link rel="prev" title="Getting help using AFQ-Insight" href="getting_help.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> AFQ-Insight
          

          
          </a>

          
            
            
              <div class="version">
                0.2.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_guide.html">User guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto_examples/index.html">General examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_help.html">Getting help using <em>AFQ-Insight</em></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pipelines">Pipelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cross-validation">Cross Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dataset-loader">Dataset Loader</a></li>
<li class="toctree-l2"><a class="reference internal" href="#transformers">Transformers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to <em>AFQ-Insight</em></a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/richford/AFQ-Insight">AFQ-Insight on GitHub</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">AFQ-Insight</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>API Reference</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h1>
<div class="section" id="pipelines">
<h2>Pipelines<a class="headerlink" href="#pipelines" title="Permalink to this headline">¶</a></h2>
<p>These are AFQ-Insights recommended estimator pipelines.</p>
<dl class="py function">
<dt id="afqinsight.make_afq_regressor_pipeline">
<code class="sig-prename descclassname">afqinsight.</code><code class="sig-name descname">make_afq_regressor_pipeline</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imputer</span><span class="o">=</span><span class="default_value">'simple'</span></em>, <em class="sig-param"><span class="n">scaler</span><span class="o">=</span><span class="default_value">'standard'</span></em>, <em class="sig-param"><span class="n">power_transformer</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">imputer_kwargs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scaler_kwargs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">power_transformer_kwargs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_cv_estimator</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">memory</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pipeline_verbosity</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">target_transformer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">target_transform_func</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">target_transform_inverse_func</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">target_transform_check_inverse</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">estimator_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/afqinsight/pipeline.html#make_afq_regressor_pipeline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#afqinsight.make_afq_regressor_pipeline" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the recommended AFQ-specific regression pipeline.</p>
<p>This function returns a <a class="reference external" href="https://scikit-learn.org/stable/modules/compose.html#pipeline" title="(in scikit-learn v0.23)"><span class="xref std std-ref">Pipeline</span></a> instance with the
following steps:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">imputer</span><span class="p">,</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">power_transformer</span><span class="p">,</span> <span class="n">estimator</span><span class="p">]</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">imputer</span></code> imputes missing data due to individual subjects missing
metrics along an entire bundle; <code class="docutils literal notranslate"><span class="pre">scaler</span></code> is optional and scales the
features of the feature matrix; <code class="docutils literal notranslate"><span class="pre">power_transformer</span></code> is optional and
applies a power transform featurewise to make data more Gaussian-like;
and <code class="docutils literal notranslate"><span class="pre">estimator</span></code> is an instance of <a class="reference external" href="https://richiehalford.org/groupyr/api.html#groupyr.SGLCV" title="(in groupyr v0.1.7)"><code class="docutils literal notranslate"><span class="pre">groupyr.SGLCV</span></code></a> if
<code class="docutils literal notranslate"><span class="pre">use_cv_estimator=True</span></code> or <a class="reference external" href="https://richiehalford.org/groupyr/api.html#groupyr.SGL" title="(in groupyr v0.1.7)"><code class="docutils literal notranslate"><span class="pre">groupyr.SGL</span></code></a> if
<code class="docutils literal notranslate"><span class="pre">use_cv_estimator=False</span></code>. The estimator may be optionally wrapped in a
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.compose.TransformedTargetRegressor.html#sklearn.compose.TransformedTargetRegressor" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.compose.TransformedTargetRegressor</span></code></a> such that the
computation during <code class="docutils literal notranslate"><span class="pre">fit</span></code> is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">target_transform_func</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">target_transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
<p>The computation during <code class="docutils literal notranslate"><span class="pre">predict</span></code> is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">target_transform_inverse_func</span><span class="p">(</span><span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">target_transformer</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</pre></div>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>imputer</strong><span class="classifier">“simple”, “knn”, or sklearn-compatible transformer, default=”simple”</span></dt><dd><p>The imputer for missing data. String arguments result in the use of
specific imputers/transformers:
“simple” yields <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html#sklearn.impute.SimpleImputer" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.impute.SimpleImputer</span></code></a>;
“knn” yields <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.KNNImputer.html#sklearn.impute.KNNImputer" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.impute.KNNImputer</span></code></a>.
Custom transformers are
allowed as long as they inherit from
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.TransformerMixin.html#sklearn.base.TransformerMixin" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></a>.</p>
</dd>
<dt><strong>scaler</strong><span class="classifier">“standard”, “minmax”, “maxabs”, “robust”, or sklearn-compatible transformer, default=”standard”</span></dt><dd><p>The scaler to use for the feature matrix. String arguments result in
the use of specific transformers: “standard” yields the
<code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.preprocessing.StandardScalar</span></code>; “minmax”
yields the <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html#sklearn.preprocessing.MinMaxScaler" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.preprocessing.MinMaxScaler</span></code></a>;
“maxabs” yields the
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MaxAbsScaler.html#sklearn.preprocessing.MaxAbsScaler" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.preprocessing.MaxAbsScaler</span></code></a>; “robust” yields
the <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.RobustScaler.html#sklearn.preprocessing.RobustScaler" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.preprocessing.RobustScaler</span></code></a>. Custom
transformers are allowed as long as they inherit from
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.TransformerMixin.html#sklearn.base.TransformerMixin" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></a>.</p>
</dd>
<dt><strong>power_transformer</strong><span class="classifier">bool or sklearn-compatible transformer, default=False</span></dt><dd><p>An optional power transformer for use on the feature matrix. If True,
use <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.PowerTransformer.html#sklearn.preprocessing.PowerTransformer" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.preprocessing.PowerTransformer</span></code></a>. If
False, skip this step. Custom transformers are allowed as long as
they inherit from <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.TransformerMixin.html#sklearn.base.TransformerMixin" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></a>.</p>
</dd>
<dt><strong>imputer_kwargs</strong><span class="classifier">dict, default=None,</span></dt><dd><p>Key-word arguments for the imputer.</p>
</dd>
<dt><strong>scaler_kwargs</strong><span class="classifier">dict, default=None,</span></dt><dd><p>Key-word arguments for the scaler.</p>
</dd>
<dt><strong>power_transformer_kwargs</strong><span class="classifier">dict, default=None,</span></dt><dd><p>Key-word arguments for the power_transformer.</p>
</dd>
<dt><strong>use_cv_estimator</strong><span class="classifier">bool, default=True,</span></dt><dd><p>If True, use <a class="reference external" href="https://richiehalford.org/groupyr/api.html#groupyr.SGLCV" title="(in groupyr v0.1.7)"><code class="docutils literal notranslate"><span class="pre">groupyr.SGLCV</span></code></a> as the final
estimator. Otherwise, use <a class="reference external" href="https://richiehalford.org/groupyr/api.html#groupyr.SGL" title="(in groupyr v0.1.7)"><code class="docutils literal notranslate"><span class="pre">groupyr.SGL</span></code></a>.</p>
</dd>
<dt><strong>memory</strong><span class="classifier">str or object with the joblib.Memory interface, default=None</span></dt><dd><p>Used to cache the fitted transformers of the pipeline. By default,
no caching is performed. If a string is given, it is the path to
the caching directory. Enabling caching triggers a clone of
the transformers before fitting. Therefore, the transformer
instance given to the pipeline cannot be inspected
directly. Use the attribute <code class="docutils literal notranslate"><span class="pre">named_steps</span></code> or <code class="docutils literal notranslate"><span class="pre">steps</span></code> to
inspect estimators within the pipeline. Caching the
transformers is advantageous when fitting is time consuming.</p>
</dd>
<dt><strong>pipeline_verbosity</strong><span class="classifier">bool, default=False</span></dt><dd><p>If True, the time elapsed while fitting each step will be printed as it
is completed.</p>
</dd>
<dt><strong>target_transformer</strong><span class="classifier">object, default=None</span></dt><dd><p>Estimator object such as derived from
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.TransformerMixin.html#sklearn.base.TransformerMixin" title="(in scikit-learn v0.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></a>. Cannot be set at the same
time as <code class="docutils literal notranslate"><span class="pre">func</span></code> and <code class="docutils literal notranslate"><span class="pre">inverse_func</span></code>. If <code class="docutils literal notranslate"><span class="pre">transformer</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>
as well as <code class="docutils literal notranslate"><span class="pre">func</span></code> and <code class="docutils literal notranslate"><span class="pre">inverse_func</span></code>, the transformer will be an
identity transformer. Note that the transformer will be cloned during
fitting. Also, the transformer is restricting <code class="docutils literal notranslate"><span class="pre">y</span></code> to be a numpy
array.</p>
</dd>
<dt><strong>target_transform_func</strong><span class="classifier">function, default=None</span></dt><dd><p>Function to apply to <code class="docutils literal notranslate"><span class="pre">y</span></code> before passing to <code class="docutils literal notranslate"><span class="pre">fit</span></code>. Cannot be set at
the same time as <code class="docutils literal notranslate"><span class="pre">transformer</span></code>. The function needs to return a
2-dimensional array. If <code class="docutils literal notranslate"><span class="pre">func</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the function used will be
the identity function.</p>
</dd>
<dt><strong>target_transform_inverse_func</strong><span class="classifier">function, default=None</span></dt><dd><p>Function to apply to the prediction of the regressor. Cannot be set at
the same time as <code class="docutils literal notranslate"><span class="pre">transformer</span></code> as well. The function needs to return
a 2-dimensional array. The inverse function is used to return
predictions to the same space of the original training labels.</p>
</dd>
<dt><strong>target_transform_check_inverse</strong><span class="classifier">bool, default=True</span></dt><dd><p>Whether to check that <code class="docutils literal notranslate"><span class="pre">transform</span></code> followed by <code class="docutils literal notranslate"><span class="pre">inverse_transform</span></code>
or <code class="docutils literal notranslate"><span class="pre">func</span></code> followed by <code class="docutils literal notranslate"><span class="pre">inverse_func</span></code> leads to the original targets.</p>
</dd>
<dt><strong>**estimator_kwargs</strong><span class="classifier">kwargs</span></dt><dd><p>Keyword arguments passed to <a class="reference external" href="https://richiehalford.org/groupyr/api.html#groupyr.SGLCV" title="(in groupyr v0.1.7)"><code class="docutils literal notranslate"><span class="pre">groupyr.SGLCV</span></code></a> if
<code class="docutils literal notranslate"><span class="pre">use_cv_estimator=True</span></code> or <a class="reference external" href="https://richiehalford.org/groupyr/api.html#groupyr.SGL" title="(in groupyr v0.1.7)"><code class="docutils literal notranslate"><span class="pre">groupyr.SGL</span></code></a> if
<code class="docutils literal notranslate"><span class="pre">use_cv_estimator=False</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>pipeline</strong><span class="classifier"><a class="reference external" href="https://scikit-learn.org/stable/modules/compose.html#pipeline" title="(in scikit-learn v0.23)"><span class="xref std std-ref">Pipeline</span></a> instance</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="afqinsight.make_afq_classifier_pipeline">
<code class="sig-prename descclassname">afqinsight.</code><code class="sig-name descname">make_afq_classifier_pipeline</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imputer</span><span class="o">=</span><span class="default_value">'simple'</span></em>, <em class="sig-param"><span class="n">scaler</span><span class="o">=</span><span class="default_value">'standard'</span></em>, <em class="sig-param"><span class="n">power_transformer</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">imputer_kwargs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scaler_kwargs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">power_transformer_kwargs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_cv_estimator</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">memory</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pipeline_verbosity</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">target_transformer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">target_transform_func</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">target_transform_inverse_func</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">target_transform_check_inverse</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">estimator_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/afqinsight/pipeline.html#make_afq_classifier_pipeline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#afqinsight.make_afq_classifier_pipeline" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the recommended AFQ-specific classification pipeline.</p>
<p>This function returns a <a class="reference external" href="https://scikit-learn.org/stable/modules/compose.html#pipeline" title="(in scikit-learn v0.23)"><span class="xref std std-ref">Pipeline</span></a> instance with the
following steps:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">imputer</span><span class="p">,</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">power_transformer</span><span class="p">,</span> <span class="n">estimator</span><span class="p">]</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">imputer</span></code> imputes missing data due to individual subjects missing
metrics along an entire bundle; <code class="docutils literal notranslate"><span class="pre">scaler</span></code> is optional and scales the
features of the feature matrix; <code class="docutils literal notranslate"><span class="pre">power_transformer</span></code> is optional and
applies a power transform featurewise to make data more Gaussian-like;
and <code class="docutils literal notranslate"><span class="pre">estimator</span></code> is an instance of
<a class="reference external" href="https://richiehalford.org/groupyr/api.html#groupyr.LogisticSGLCV" title="(in groupyr v0.1.7)"><code class="docutils literal notranslate"><span class="pre">groupyr.LogisticSGLCV</span></code></a> if <code class="docutils literal notranslate"><span class="pre">use_cv_estimator=True</span></code> or
<a class="reference external" href="https://richiehalford.org/groupyr/api.html#groupyr.LogisticSGL" title="(in groupyr v0.1.7)"><code class="docutils literal notranslate"><span class="pre">groupyr.LogisticSGL</span></code></a> if <code class="docutils literal notranslate"><span class="pre">use_cv_estimator=False</span></code>. The
estimator may be optionally wrapped in a
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.compose.TransformedTargetRegressor.html#sklearn.compose.TransformedTargetRegressor" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.compose.TransformedTargetRegressor</span></code></a> such that the
computation during <code class="docutils literal notranslate"><span class="pre">fit</span></code> is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">target_transform_func</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">target_transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
<p>The computation during <code class="docutils literal notranslate"><span class="pre">predict</span></code> is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">target_transform_inverse_func</span><span class="p">(</span><span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">target_transformer</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</pre></div>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>imputer</strong><span class="classifier">“simple”, “knn”, or sklearn-compatible transformer, default=”simple”</span></dt><dd><p>The imputer for missing data. String arguments result in the use of
specific imputers/transformers:
“simple” yields <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html#sklearn.impute.SimpleImputer" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.impute.SimpleImputer</span></code></a>;
“knn” yields <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.KNNImputer.html#sklearn.impute.KNNImputer" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.impute.KNNImputer</span></code></a>.
Custom transformers are
allowed as long as they inherit from
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.TransformerMixin.html#sklearn.base.TransformerMixin" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></a>.</p>
</dd>
<dt><strong>scaler</strong><span class="classifier">“standard”, “minmax”, “maxabs”, “robust”, or sklearn-compatible transformer, default=”standard”</span></dt><dd><p>The scaler to use for the feature matrix. String arguments result in
the use of specific transformers: “standard” yields the
<code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.preprocessing.StandardScalar</span></code>; “minmax”
yields the <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html#sklearn.preprocessing.MinMaxScaler" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.preprocessing.MinMaxScaler</span></code></a>;
“maxabs” yields the
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MaxAbsScaler.html#sklearn.preprocessing.MaxAbsScaler" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.preprocessing.MaxAbsScaler</span></code></a>; “robust” yields
the <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.RobustScaler.html#sklearn.preprocessing.RobustScaler" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.preprocessing.RobustScaler</span></code></a>. Custom
transformers are allowed as long as they inherit from
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.TransformerMixin.html#sklearn.base.TransformerMixin" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></a>.</p>
</dd>
<dt><strong>power_transformer</strong><span class="classifier">bool or sklearn-compatible transformer, default=False</span></dt><dd><p>An optional power transformer for use on the feature matrix. If True,
use <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.PowerTransformer.html#sklearn.preprocessing.PowerTransformer" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.preprocessing.PowerTransformer</span></code></a>. If
False, skip this step. Custom transformers are allowed as long as
they inherit from <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.TransformerMixin.html#sklearn.base.TransformerMixin" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></a>.</p>
</dd>
<dt><strong>imputer_kwargs</strong><span class="classifier">dict, default=None,</span></dt><dd><p>Key-word arguments for the imputer.</p>
</dd>
<dt><strong>scaler_kwargs</strong><span class="classifier">dict, default=None,</span></dt><dd><p>Key-word arguments for the scaler.</p>
</dd>
<dt><strong>power_transformer_kwargs</strong><span class="classifier">dict, default=None,</span></dt><dd><p>Key-word arguments for the power_transformer.</p>
</dd>
<dt><strong>use_cv_estimator</strong><span class="classifier">bool, default=True,</span></dt><dd><p>If True, use <a class="reference external" href="https://richiehalford.org/groupyr/api.html#groupyr.LogisticSGLCV" title="(in groupyr v0.1.7)"><code class="docutils literal notranslate"><span class="pre">groupyr.LogisticSGLCV</span></code></a> as the final
estimator. Otherwise, use <a class="reference external" href="https://richiehalford.org/groupyr/api.html#groupyr.LogisticSGL" title="(in groupyr v0.1.7)"><code class="docutils literal notranslate"><span class="pre">groupyr.LogisticSGL</span></code></a>.</p>
</dd>
<dt><strong>memory</strong><span class="classifier">str or object with the joblib.Memory interface, default=None</span></dt><dd><p>Used to cache the fitted transformers of the pipeline. By default,
no caching is performed. If a string is given, it is the path to
the caching directory. Enabling caching triggers a clone of
the transformers before fitting. Therefore, the transformer
instance given to the pipeline cannot be inspected
directly. Use the attribute <code class="docutils literal notranslate"><span class="pre">named_steps</span></code> or <code class="docutils literal notranslate"><span class="pre">steps</span></code> to
inspect estimators within the pipeline. Caching the
transformers is advantageous when fitting is time consuming.</p>
</dd>
<dt><strong>pipeline_verbosity</strong><span class="classifier">bool, default=False</span></dt><dd><p>If True, the time elapsed while fitting each step will be printed as it
is completed.</p>
</dd>
<dt><strong>target_transformer</strong><span class="classifier">object, default=None</span></dt><dd><p>Estimator object such as derived from
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.TransformerMixin.html#sklearn.base.TransformerMixin" title="(in scikit-learn v0.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></a>. Cannot be set at the same
time as <code class="docutils literal notranslate"><span class="pre">func</span></code> and <code class="docutils literal notranslate"><span class="pre">inverse_func</span></code>. If <code class="docutils literal notranslate"><span class="pre">transformer</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>
as well as <code class="docutils literal notranslate"><span class="pre">func</span></code> and <code class="docutils literal notranslate"><span class="pre">inverse_func</span></code>, the transformer will be an
identity transformer. Note that the transformer will be cloned during
fitting. Also, the transformer is restricting <code class="docutils literal notranslate"><span class="pre">y</span></code> to be a numpy
array.</p>
</dd>
<dt><strong>target_transform_func</strong><span class="classifier">function, default=None</span></dt><dd><p>Function to apply to <code class="docutils literal notranslate"><span class="pre">y</span></code> before passing to <code class="docutils literal notranslate"><span class="pre">fit</span></code>. Cannot be set at
the same time as <code class="docutils literal notranslate"><span class="pre">transformer</span></code>. The function needs to return a
2-dimensional array. If <code class="docutils literal notranslate"><span class="pre">func</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the function used will be
the identity function.</p>
</dd>
<dt><strong>target_transform_inverse_func</strong><span class="classifier">function, default=None</span></dt><dd><p>Function to apply to the prediction of the regressor. Cannot be set at
the same time as <code class="docutils literal notranslate"><span class="pre">transformer</span></code> as well. The function needs to return
a 2-dimensional array. The inverse function is used to return
predictions to the same space of the original training labels.</p>
</dd>
<dt><strong>target_transform_check_inverse</strong><span class="classifier">bool, default=True</span></dt><dd><p>Whether to check that <code class="docutils literal notranslate"><span class="pre">transform</span></code> followed by <code class="docutils literal notranslate"><span class="pre">inverse_transform</span></code>
or <code class="docutils literal notranslate"><span class="pre">func</span></code> followed by <code class="docutils literal notranslate"><span class="pre">inverse_func</span></code> leads to the original targets.</p>
</dd>
<dt><strong>**estimator_kwargs</strong><span class="classifier">kwargs</span></dt><dd><p>Keyword arguments passed to <a class="reference external" href="https://richiehalford.org/groupyr/api.html#groupyr.LogisticSGLCV" title="(in groupyr v0.1.7)"><code class="docutils literal notranslate"><span class="pre">groupyr.LogisticSGLCV</span></code></a> if
<code class="docutils literal notranslate"><span class="pre">use_cv_estimator=True</span></code> or <a class="reference external" href="https://richiehalford.org/groupyr/api.html#groupyr.LogisticSGL" title="(in groupyr v0.1.7)"><code class="docutils literal notranslate"><span class="pre">groupyr.LogisticSGL</span></code></a> if
<code class="docutils literal notranslate"><span class="pre">use_cv_estimator=False</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>pipeline</strong><span class="classifier"><a class="reference external" href="https://scikit-learn.org/stable/modules/compose.html#pipeline" title="(in scikit-learn v0.23)"><span class="xref std std-ref">Pipeline</span></a> instance</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="cross-validation">
<h2>Cross Validation<a class="headerlink" href="#cross-validation" title="Permalink to this headline">¶</a></h2>
<p>This function validates model performance using cross-validation, while
checkpointing the estimators and scores.</p>
<dl class="py function">
<dt id="afqinsight.cross_validate_checkpoint">
<code class="sig-prename descclassname">afqinsight.</code><code class="sig-name descname">cross_validate_checkpoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">estimator</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">groups</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scoring</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cv</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_jobs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">fit_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pre_dispatch</span><span class="o">=</span><span class="default_value">'2*n_jobs'</span></em>, <em class="sig-param"><span class="n">return_train_score</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">return_estimator</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">error_score</span><span class="o">=</span><span class="default_value">nan</span></em>, <em class="sig-param"><span class="n">workdir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">checkpoint</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">force_refresh</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/afqinsight/cross_validate.html#cross_validate_checkpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#afqinsight.cross_validate_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate metric(s) by cross-validation and also record fit/score times.</p>
<p>This is a copy of <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_validate.html#sklearn.model_selection.cross_validate" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.model_selection.cross_validate()</span></code></a>
that uses <code class="xref py py-func docutils literal notranslate"><span class="pre">_fit_and_score_ckpt()</span></code> to checkpoint scores and estimators
for each CV split.
Read more in the <a class="reference external" href="https://scikit-learn.org/stable/modules/cross_validation.html#multimetric-cross-validation" title="(in scikit-learn v0.23)"><span class="xref std std-ref">sklearn user guide</span></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>estimator</strong><span class="classifier">estimator object implementing ‘fit’</span></dt><dd><p>The object to use to fit the data.</p>
</dd>
<dt><strong>X</strong><span class="classifier">array-like of shape (n_samples, n_features)</span></dt><dd><p>The data to fit. Can be for example a list, or an array.</p>
</dd>
<dt><strong>y</strong><span class="classifier">array-like of shape (n_samples,) or (n_samples, n_outputs), default=None</span></dt><dd><p>The target variable to try to predict in the case of
supervised learning.</p>
</dd>
<dt><strong>groups</strong><span class="classifier">array-like of shape (n_samples,), default=None</span></dt><dd><p>Group labels for the samples used while splitting the dataset into
train/test set. Only used in conjunction with a “Group” <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-cv" title="(in scikit-learn v0.23)"><span class="xref std std-term">cv</span></a>
instance (e.g., <code class="xref py py-class docutils literal notranslate"><span class="pre">GroupKFold</span></code>).</p>
</dd>
<dt><strong>scoring</strong><span class="classifier">str, callable, list/tuple, or dict, default=None</span></dt><dd><p>A single str (see <a class="reference external" href="https://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter" title="(in scikit-learn v0.23)"><span>The scoring parameter: defining model evaluation rules</span></a>) or a callable
(see <a class="reference external" href="https://scikit-learn.org/stable/modules/model_evaluation.html#scoring" title="(in scikit-learn v0.23)"><span>Defining your scoring strategy from metric functions</span></a>) to evaluate the predictions on the test set.</p>
<p>For evaluating multiple metrics, either give a list of (unique) strings
or a dict with names as keys and callables as values.</p>
<p>NOTE that when using custom scorers, each scorer should return a single
value. Metric functions returning a list/array of values can be wrapped
into multiple scorers that return one value each.</p>
<p>See <a class="reference external" href="https://scikit-learn.org/stable/modules/grid_search.html#multimetric-grid-search" title="(in scikit-learn v0.23)"><span>Specifying multiple metrics for evaluation</span></a> for an example.</p>
<p>If None, the estimator’s score method is used.</p>
</dd>
<dt><strong>cv</strong><span class="classifier">int, cross-validation generator or an iterable, default=None</span></dt><dd><p>Determines the cross-validation splitting strategy.
Possible inputs for cv are:</p>
<ul class="simple">
<li><p>None, to use the default 5-fold cross validation,</p></li>
<li><p>int, to specify the number of folds in a <cite>(Stratified)KFold</cite>,</p></li>
<li><p>an sklearn <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-cv-splitter">CV splitter</a>,</p></li>
<li><p>An iterable yielding (train, test) splits as arrays of indices.</p></li>
</ul>
<p>For int/None inputs, if the estimator is a classifier and <code class="docutils literal notranslate"><span class="pre">y</span></code> is
either binary or multiclass,
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.StratifiedKFold.html#sklearn.model_selection.StratifiedKFold" title="(in scikit-learn v0.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.model_selection.StratifiedKFold</span></code></a> is used. In all
other cases, <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html#sklearn.model_selection.KFold" title="(in scikit-learn v0.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.model_selection.KFold</span></code></a> is used.
Refer <a class="reference external" href="https://scikit-learn.org/stable/modules/cross_validation.html#cross-validation" title="(in scikit-learn v0.23)"><span class="xref std std-ref">sklearn user guide</span></a> for the
various cross-validation strategies that can be used here.</p>
</dd>
<dt><strong>n_jobs</strong><span class="classifier">int, default=None</span></dt><dd><p>The number of CPUs to use to do the computation.
<code class="docutils literal notranslate"><span class="pre">None</span></code> means 1 unless in a <a class="reference external" href="https://joblib.readthedocs.io/en/latest/parallel.html#joblib.parallel_backend" title="(in joblib v0.18.0.dev0)"><code class="docutils literal notranslate"><span class="pre">joblib.parallel_backend</span></code></a> context.
<code class="docutils literal notranslate"><span class="pre">-1</span></code> means using all processors. See <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-n-jobs" title="(in scikit-learn v0.23)"><span class="xref std std-term">sklearn Glossary</span></a>
for more details.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">int, default=0</span></dt><dd><p>The verbosity level.</p>
</dd>
<dt><strong>fit_params</strong><span class="classifier">dict, default=None</span></dt><dd><p>Parameters to pass to the fit method of the estimator.</p>
</dd>
<dt><strong>pre_dispatch</strong><span class="classifier">int or str, default=’2*n_jobs’</span></dt><dd><p>Controls the number of jobs that get dispatched during parallel
execution. Reducing this number can be useful to avoid an
explosion of memory consumption when more jobs get dispatched
than CPUs can process. This parameter can be:</p>
<blockquote>
<div><ul class="simple">
<li><p>None, in which case all the jobs are immediately
created and spawned. Use this for lightweight and
fast-running jobs, to avoid delays due to on-demand
spawning of the jobs</p></li>
<li><p>An int, giving the exact number of total jobs that are
spawned</p></li>
<li><p>A str, giving an expression as a function of n_jobs,
as in ‘2*n_jobs’</p></li>
</ul>
</div></blockquote>
</dd>
<dt><strong>return_train_score</strong><span class="classifier">bool, default=False</span></dt><dd><p>Whether to include train scores.
Computing training scores is used to get insights on how different
parameter settings impact the overfitting/underfitting trade-off.
However computing the scores on the training set can be computationally
expensive and is not strictly required to select the parameters that
yield the best generalization performance.</p>
</dd>
<dt><strong>return_estimator</strong><span class="classifier">bool, default=False</span></dt><dd><p>Whether to return the estimators fitted on each split.</p>
</dd>
<dt><strong>error_score</strong><span class="classifier">‘raise’ or numeric</span></dt><dd><p>Value to assign to the score if an error occurs in estimator fitting.
If set to ‘raise’, the error is raised.
If a numeric value is given, FitFailedWarning is raised. This parameter
does not affect the refit step, which will always raise the error.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>scores</strong><span class="classifier">dict of float arrays of shape (n_splits,)</span></dt><dd><p>Array of scores of the estimator for each run of the cross validation.</p>
<p>A dict of arrays containing the score/time arrays for each scorer is
returned. The possible keys for this <code class="docutils literal notranslate"><span class="pre">dict</span></code> are:</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">test_score</span></code></dt><dd><p>The score array for test scores on each cv split.
Suffix <code class="docutils literal notranslate"><span class="pre">_score</span></code> in <code class="docutils literal notranslate"><span class="pre">test_score</span></code> changes to a specific
metric like <code class="docutils literal notranslate"><span class="pre">test_r2</span></code> or <code class="docutils literal notranslate"><span class="pre">test_auc</span></code> if there are
multiple scoring metrics in the scoring parameter.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">train_score</span></code></dt><dd><p>The score array for train scores on each cv split.
Suffix <code class="docutils literal notranslate"><span class="pre">_score</span></code> in <code class="docutils literal notranslate"><span class="pre">train_score</span></code> changes to a specific
metric like <code class="docutils literal notranslate"><span class="pre">train_r2</span></code> or <code class="docutils literal notranslate"><span class="pre">train_auc</span></code> if there are
multiple scoring metrics in the scoring parameter.
This is available only if <code class="docutils literal notranslate"><span class="pre">return_train_score</span></code> parameter
is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">fit_time</span></code></dt><dd><p>The time for fitting the estimator on the train
set for each cv split.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">score_time</span></code></dt><dd><p>The time for scoring the estimator on the test set for each
cv split. (Note time for scoring on the train set is not
included even if <code class="docutils literal notranslate"><span class="pre">return_train_score</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">estimator</span></code></dt><dd><p>The estimator objects for each cv split.
This is available only if <code class="docutils literal notranslate"><span class="pre">return_estimator</span></code> parameter
is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html#sklearn.model_selection.cross_val_score" title="(in scikit-learn v0.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sklearn.model_selection.cross_val_score</span></code></a></dt><dd><p>Run cross-validation for single metric evaluation.</p>
</dd>
<dt><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_predict.html#sklearn.model_selection.cross_val_predict" title="(in scikit-learn v0.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sklearn.model_selection.cross_val_predict</span></code></a></dt><dd><p>Get predictions from each split of cross-validation for diagnostic purposes.</p>
</dd>
<dt><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.make_scorer.html#sklearn.metrics.make_scorer" title="(in scikit-learn v0.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sklearn.metrics.make_scorer</span></code></a></dt><dd><p>Make a scorer from a performance metric or loss function.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">shutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tempfile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">linear_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">afqinsight</span> <span class="kn">import</span> <span class="n">cross_validate_checkpoint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diabetes</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_diabetes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">diabetes</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="mi">150</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">diabetes</span><span class="o">.</span><span class="n">target</span><span class="p">[:</span><span class="mi">150</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lasso</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Lasso</span><span class="p">()</span>
</pre></div>
</div>
<p>Single metric evaluation using <code class="docutils literal notranslate"><span class="pre">cross_validate</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cv_results</span> <span class="o">=</span> <span class="n">cross_validate_checkpoint</span><span class="p">(</span><span class="n">lasso</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">checkpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">cv_results</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="go">[&#39;fit_time&#39;, &#39;score_time&#39;, &#39;test_score&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cv_results</span><span class="p">[</span><span class="s1">&#39;test_score&#39;</span><span class="p">]</span>
<span class="go">array([0.33150734, 0.08022311, 0.03531764])</span>
</pre></div>
</div>
<p>Multiple metric evaluation using <code class="docutils literal notranslate"><span class="pre">cross_validate</span></code>, an estimator
pipeline, and checkpointing (please refer the <code class="docutils literal notranslate"><span class="pre">scoring</span></code> parameter doc
for more information)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tempdir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">scaler</span><span class="p">,</span> <span class="n">lasso</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span> <span class="o">=</span> <span class="n">cross_validate_checkpoint</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">scoring</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="s1">&#39;neg_mean_squared_error&#39;</span><span class="p">),</span>
<span class="gp">... </span>                        <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">checkpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">workdir</span><span class="o">=</span><span class="n">tempdir</span><span class="p">,</span> <span class="n">return_estimator</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">tempdir</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="s1">&#39;test_neg_mean_squared_error&#39;</span><span class="p">])</span>
<span class="go">[-2479.2... -3281.2... -3466.7...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="s1">&#39;train_r2&#39;</span><span class="p">])</span>
<span class="go">[0.507... 0.602... 0.478...]</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="dataset-loader">
<h2>Dataset Loader<a class="headerlink" href="#dataset-loader" title="Permalink to this headline">¶</a></h2>
<p>This function reads data from csv files conforming to the AFQ data standard
and return feature and target matrices, grouping arrays, and subject IDs.</p>
<dl class="py function">
<dt id="afqinsight.load_afq_data">
<code class="sig-prename descclassname">afqinsight.</code><code class="sig-name descname">load_afq_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">workdir</span></em>, <em class="sig-param"><span class="n">target_cols</span></em>, <em class="sig-param"><span class="n">label_encode_cols</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">index_col</span><span class="o">=</span><span class="default_value">'subjectID'</span></em>, <em class="sig-param"><span class="n">fn_nodes</span><span class="o">=</span><span class="default_value">'nodes.csv'</span></em>, <em class="sig-param"><span class="n">fn_subjects</span><span class="o">=</span><span class="default_value">'subjects.csv'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/afqinsight/datasets.html#load_afq_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#afqinsight.load_afq_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load AFQ data from CSV, transform it, return feature matrix and target.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>workdir</strong><span class="classifier">str</span></dt><dd><p>Directory in which to find the AFQ csv files</p>
</dd>
<dt><strong>target_cols</strong><span class="classifier">list of strings</span></dt><dd><p>List of column names in subjects csv file to use as target variables</p>
</dd>
<dt><strong>label_encode_cols</strong><span class="classifier">list of strings, subset of target_cols</span></dt><dd><p>Must be a subset of target_cols. These columns will be encoded using
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html#sklearn.preprocessing.LabelEncoder" title="(in scikit-learn v0.23)"><code class="docutils literal notranslate"><span class="pre">sklearn.preprocessing.LabelEncoder</span></code></a>.</p>
</dd>
<dt><strong>index_col</strong><span class="classifier">str, default=’subjectID’</span></dt><dd><p>The name of column in the subject csv file to use as the index. This
should contain subject IDs.</p>
</dd>
<dt><strong>fn_nodes</strong><span class="classifier">str, default=’nodes.csv’</span></dt><dd><p>Filename for the nodes csv file.</p>
</dd>
<dt><strong>fn_subjects</strong><span class="classifier">str, default=’subjects.csv’</span></dt><dd><p>Filename for the subjects csv file.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>X</strong><span class="classifier">array-like of shape (n_samples, n_features)</span></dt><dd><p>The feature samples.</p>
</dd>
<dt><strong>y</strong><span class="classifier">array-like of shape (n_samples,) or (n_samples, n_targets), optional</span></dt><dd><p>Target values.</p>
</dd>
<dt><strong>groups</strong><span class="classifier">list of numpy.ndarray</span></dt><dd><p>feature indices for each feature group</p>
</dd>
<dt><strong>feature_names</strong><span class="classifier">list of tuples</span></dt><dd><p>The multi-indexed columns of X</p>
</dd>
<dt><strong>subjects</strong><span class="classifier">list</span></dt><dd><p>Subject IDs</p>
</dd>
<dt><strong>classes</strong><span class="classifier">dict</span></dt><dd><p>Class labels for each column specified in <code class="docutils literal notranslate"><span class="pre">label_encode_cols</span></code></p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform.AFQDataFrameMapper</span></code></dt><dd></dd>
</dl>
</div>
</dd></dl>

</div>
<div class="section" id="transformers">
<h2>Transformers<a class="headerlink" href="#transformers" title="Permalink to this headline">¶</a></h2>
<p>These transformers transform tractometry information from the AFQ standard
data format to feature matrices that are ready for ingestion into
sklearn-compatible pipelines.</p>
<dl class="py class">
<dt id="afqinsight.AFQDataFrameMapper">
<em class="property">class </em><code class="sig-prename descclassname">afqinsight.</code><code class="sig-name descname">AFQDataFrameMapper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pd_interpolate_kwargs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">dataframe_mapper_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/afqinsight/transform.html#AFQDataFrameMapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#afqinsight.AFQDataFrameMapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Map pandas dataframe to sklearn feature matrix.</p>
<p>This object first converts an AFQ nodes.csv dataframe into a feature
matrix with rows corresponding to subjects and columns corresponding to
tract profile values. It interpolates along tracts to fill missing values
and then maps the dataframe onto a 2D feature matrix for ingestion into
sklearn-compatible estimators. It also maintains attributes for the
subject index, feature names, and groups of features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df_mapper_params</strong><span class="classifier">kwargs, default=dict(features=[], default=None)</span></dt><dd><p>Keyword arguments passed to sklearn_pandas.DataFrameMapper. You will
probably not need to change these defaults.</p>
</dd>
<dt><strong>pd_interpolate_params</strong><span class="classifier">kwargs, default=dict(method=”linear”, limit_direction=”both”, limit_area=”inside”)</span></dt><dd><p>Keyword arguments passed to pandas.DataFrame.interpolate. Missing
values are interpolated within the tract profile so that no data is
used from other subjects, tracts, or metrics, minimizing the chance
of train/test leakage. You will probably not need to change these
defaults.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>subjects_</strong><span class="classifier">list</span></dt><dd><p>List of subject IDs retrieved from pandas dataframe index.</p>
</dd>
<dt><strong>groups_</strong><span class="classifier">list of numpy.ndarray</span></dt><dd><p>List of arrays of non-overlapping indices for each group. For
example, if nine features are grouped into equal contiguous groups of
three, then groups would be <code class="docutils literal notranslate"><span class="pre">[array([0,</span> <span class="pre">1,</span> <span class="pre">2]),</span> <span class="pre">array([3,</span> <span class="pre">4,</span> <span class="pre">5]),</span>
<span class="pre">array([6,</span> <span class="pre">7,</span> <span class="pre">8])]</span></code>.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">feature_names_</span></code><span class="classifier">list of tuples</span></dt><dd><p>Return the feature names.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="contributing.html" class="btn btn-neutral float-right" title="Contributing to AFQ-Insight" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="getting_help.html" class="btn btn-neutral float-left" title="Getting help using AFQ-Insight" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Adam Richie-Halford

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>